# 합성곱 신경망

합성곱 신경망은 이미지 전체를 한 번에 계산하는 것이 아닌 이미지의 국소적 부분을 계산함으로써 시간과 자원을 절약하여 이미지의 세밀한 부분까지 분석하는 신경망 구조



기존의 MLP구조에서는 이미지를 펼쳐서(벡터화)해서 flatten 해놓고 학습을 했다. 이러한 경우 공간적 정보(spatial information)을 잃게 된다. 이러한 부분을 방지하고자 합성곱 신경망을 도입했다.



주로 음성 인식, 이미지/영상 인식에서 주로 사용되는 신경망 구조다.

1 channel (Grayscale), 3 channel (RGB) 모두 적용 가능하다.



## 구조

1. 입력층
   - 입력 이미지를 받는 층
2. 합성곱층
   - 입력 이미지로부터 특성을 추출하는 층
   - 필터가 이미지의 영역을 훑으면서 특성을 추출한다.
   - 이때 추출된 결과가 피처맵(feature map)이라 한다.
   - 이때 필터의 커널 사이즈는 3x3, 5x5 가 주로 쓰이며, 스트라이드는 필터가 한번 움직일 때 움직이는 정도를 나타낸다. 보통의 경우 1
3. 풀링층
   - 피처맵의 차원을 다운 샘플링하여 연산량을 감소시키고, 주요한 특성 벡터를 추출하여 학습을 ㅎ과적으로 할 수 있게 해준다.
   - max pooling : 영역에서 최대값 추출
   - average pooling : 영역에서 평균값 반환
   - 주로 사용하는 것은 max pooling이다. 평균은 커널값을 평균으로 바꾸기에 중요한 가중치를 갖는 특성이 희미해질 수 있기 때문이다.
4. 완전연결층
   - 최종적으로 나온 피처맵을 flatten 시켜 벡터화 시킨다.
   - 여기서부턴 일반적인 MLP와 동일하다.
5. 출력층
   - 소프트맥스 활성 함수를 사용해 입력받은 값을 0 에서 1 사이의 값으로 출력해준다.



## 1 x 1 합성곱

커널사이즈가 1x1이고 채널은 입력과 동일하게 합성곱을 진행한다. 

필터의 개수를 조절해 연산량을 감소시키는 효과가 있다. 대표적으론 inception(GoogLeNet) 이 있다.



